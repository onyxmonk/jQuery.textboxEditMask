var _this=this,textboxEditMask,editMaskPatterns;jQuery.fn.outerHTML=function(n){return n?this.before(n).remove():jQuery("&lt;p&gt;").append(this.eq(0).clone()).html()},$(document).ready(function(){$(":input[editMask]").each(function(){var n=$(this).attr("editMask"),t=$(this).attr("defaultEditMask");$(this).setMask(n,t)})}),$.fn.extend({setMask:function(n,t,i){var r,u=$(this);if(u.data("editMask")!=null&&(r=u.data("editMask")),n==null||n==""){r!=null&&u.data("editMask",null);return}r==null?(r=new textboxEditMask(this,n,t,i),u.data("editMask",r)):r.editMask=n}}),$.extend({getMaskObject:function(){var n=$(this);return n==null?null:n.data("editMask")}}),textboxEditMask=function(){function n(n,t,i,r){this.textBox=n,this.editMask=t,this.defaultText=i,this.validationHandler=r,this._wildcards="#&@_><!^",this.init()}return n.prototype.processKeyPress=function(){this.isKeyNonprintable(event.keyCode)==!0?this.processNonPrintableKeyPress():this.processPrintableKeyPress()},n.prototype.init=function(){var n=this,t=$(this.textBox);t.keydown(function(){n.processKeyPress()}),t.keypress(function(){n.fixCharacterCase()}),t.keyup(function(){event.keyCode!=8&&event.keyCode!=37&&n.positionAtNextEditable(),n.validate()}),this.setMask(this.editMask)},n.prototype.caretPos=function(){var t=0,n;if(this.textBox.selectionStart!=null)t=this.textBox.selectionStart;else if(document.selection)for(n=document.selection.createRange().duplicate(),n.parentElement()!=this.textBox&&($(this.textBox).focus(),n=document.selection.createRange().duplicate());n.move("character",-1)!=0;)t++;return t},n.prototype.inputValue=function(n){if(n!=null)$(this.textBox).val(n);else return $(this.textBox).val()},n.prototype.isInputAllowed=function(n){if(n==null)return!1;if(n.length>2)return!0;var t=n.substring(0,1);return t=="\\"?!1:n.length==2?!0:this._wildcards.indexOf(t)>-1?!0:!1},n.prototype.moveForward=function(){return this.caretPos()==this.inputValue().length?!1:(this.moveTo(this.caretPos()+1),!0)},n.prototype.moveBackward=function(){return this.caretPos()==0?!1:(this.moveTo(this.caretPos()-1),!0)},n.prototype.moveToStart=function(){this.moveTo(0)},n.prototype.moveToEnd=function(){this.moveTo(999999)},n.prototype.moveTo=function(n,t){if(n<0&&(n=0),n>this.inputValue().length&&(n=this.inputValue().length),(t==null||t<0)&&(t=0),t+n>this.inputValue().length&&(t=this.inputValue().length-n),this.textBox.setSelectionRange)this.textBox.setSelectionRange(n,n+t);else{var i=document.selection.createRange().duplicate();i.move("character",n-this.caretPos()),i.moveEnd("character",t),i.select()}},n.prototype.positionAtPreviousEditable=function(){return this._positionAtEditable(!0)},n.prototype.positionAtNextEditable=function(){return this._positionAtEditable(!1)},n.prototype._positionAtEditable=function(n){var r=0,t,i;if(n==!0&&(r=-1),t=this.caretPos()+r,t==this.validateThroughPos(t)){if(i=this.lookupMask(t),i=="")return!1;while(!this.isInputAllowed(i)){if(n==!0){if(this.moveBackward()==!1)return!1;this.placeChar(this.getDefaultMaskForPosition(t),!0)}else{if(this.placeChar(i,!0),this.moveForward()==!1)return!1;this.caretPos()==this.inputValue().length&&this.validateThroughPos(this.caretPos())}t=this.caretPos()+r,i=this.lookupMask(t)}return!0}},n.prototype.validate=function(){return this.isValidAndComplete()==!0?($(this.textBox).addClass("editMaskValidated"),$(this.textBox).removeClass("editMaskNotValidated"),!0):($(this.textBox).removeClass("editMaskValidated"),$(this.textBox).addClass("editMaskNotValidated"),!1)},n.prototype.isValidAndComplete=function(){var t=!0,i=this.inputValue(),n;if(this.validateThroughPos(-1,!1)!=i.length)t=!1;else for(n=0;n<i.length&&t==!0;n++)t=this.isKeyCodeGoodAtPosition(i.substring(n,n+1).charCodeAt(0),n);return t},n.prototype.validateThroughPos=function(n,t){var r,u,i;if((typeof t=="undefined"&&(t=!0),this._validateArray==null)||n>-1&&(this._validateArray.length<=n||this._validateArray[n]==null))return n;for(n==-1&&(n=this.inputValue().length),r=0,u=n>this._validateArray.length?this._validateArray.length:n,i=0;i<=u;i++)if(this._validateArray[i]!=null){if(this._validateArray[i]!=".novalidation"){var f=this._validateArray[i],e=this.inputValue().substring(r,i),o=new RegExp(f);if(o.test(e)==!1)return t==!0&&this.moveTo(r,i-r),r}r=i}return this.validationHandler!=null&&this.validationHandler(this),n},n.prototype.setMask=function(n){this.editMask=n,this.parseMask(),this.inputValue()==""&&this.inputValue(this.getDefaultMask()),this.validate()},n.prototype.getDefaultMask=function(){var t="",n;if(this._maskArray.length>0)for(n=0;n<this._maskArray.length;n++)t+=this.getDefaultMaskForPosition(n);return t},n.prototype.getDefaultMaskForPosition=function(n){return this.defaultText==null||this.defaultText.length<n?this.getDefaultMaskForToken(this._maskArray[n]):this.defaultText.substr(n,1)},n.prototype.getDefaultMaskForToken=function(n){return n.length==1&&this._wildcards.indexOf(n)!=-1?n=="#"?"0":" ":n.length==1||n.length==2&&n.substring(0,1)=="\\"?this.replaceAll(n,"\\",""):n.indexOf(" ")!=-1?" ":n.substring(0,1)},n.prototype.getDefaultInputForToken=function(n){return n=="#"?" ":this.getDefaultMaskForToken(n)},n.prototype.getDefaultInputForPosition=function(n){return this.defaultText==null||this.defaultText.length<n?this.getDefaultInputForToken(this._maskArray[n]):this.getDefaultMaskForPosition(n)},n.prototype.isKeyUppercase=function(n){return n>=65&&n<=90},n.prototype.isKeyLowercase=function(n){return n>=97&&n<=122},n.prototype.isKeyAlpha=function(n){return this.isKeyUppercase(n)||this.isKeyLowercase(n)},n.prototype.isKeyNumeric=function(n){return n>=48&&n<=57},n.prototype.isKeyNonprintable=function(n){return n==16?!0:n>=35&&n<=40?!0:n==9?!0:!1},n.prototype.toLowercaseKey=function(n){return this.isKeyAlpha(n)&&!this.isKeyLowercase(n)?n+32:n},n.prototype.toUppercaseKey=function(n){return this.isKeyAlpha(n)&&!this.isKeyUppercase(n)?n-32:n},n.prototype.toCharFromKey=function(n){return decodeURI("%"+n.toString(16))},n.prototype.fixCharacterCase=function(){for(var f=this.caretPos(),u=this.lookupMask(f),t=!1,i,r,n=0;n<u.length;n++){i=u.substring(n,n+1);switch(i){case"_":case"@":case"&":case"#":return;case">":this.isKeyUppercase(event.keyCode)&&(t=!0);break;case"<":this.isKeyLowercase(event.keyCode)&&(t=!0);break;case"!":(this.isKeyNumeric(event.keyCode)||this.isKeyLowercase(event.keyCode))&&(t=!0);break;case"^":(this.isKeyNumeric(event.keyCode)||this.isKeyUppercase(event.keyCode))&&(t=!0);break;default:i=="\\"&&(n++,i=u.substring(n,n+1)),i.charCodeAt(0)==event.keyCode&&(t=!0)}if(t==!0)return}r=event.keyCode,this.isKeyUppercase(r)?r+=32:r-=32,this.placeKey(r)},n.prototype.placeKey=function(n){event.returnValue=!1,this.placeChar(this.toCharFromKey(n))},n.prototype.placeChar=function(n,t){var i=1,r;t==!0&&(i=0),r=this.caretPos(),this.inputValue(this.inputValue().substr(0,this.caretPos())+n+this.inputValue().substr(this.caretPos()+1,99999)),this.moveTo(r+i)},n.prototype.parseMask=function(){var n=this.replaceAll(this.editMask,"\\[","�"),t,f,e,o;n=this.replaceAll(n,"\\]","�"),this._validateArray=[];var r=[],i=0,u=0;for(t=0;t<n.length;t++)f=n.substring(u,t),e=n.substring(t,t+1),e=="["&&(i++,i==1&&(this.processConsecutive(this.replaceAll(this.replaceAll(f,"�","["),"�","]"),r),u=t+1)),e=="]"&&(i--,i==0&&(o=this.processGroup(this.replaceAll(this.replaceAll(f,"�","["),"�","]"),r),o!=""&&r.push(o),u=t+1),i<0&&(i=0));u<n.length&&this.processConsecutive(this.replaceAll(this.replaceAll(n.substring(u,n.length),"�","["),"�","]"),r),this._maskArray=r},n.prototype.processGroup=function(n,t){var f,i,r,u;if(n.substring(0,1)=="*")return f=t.length,this._validateArray.length=f,this._validateArray[f]=this.replaceAll(n.substring(1,n.length),"#","\\d"),"";if(n=this.replaceAll(n,"\\-","�"),i=n.indexOf("-"),i>=0){for(r="",u=n.charCodeAt(i-1)+1;u<n.charCodeAt(i+1);u++)r=r+String.fromCharCode(u);n=this.replaceAll(n,"-",r)}return this.replaceAll(n,"�","\\-")},n.prototype.processConsecutive=function(n,t){for(var r,u,o,f,i=0;i<n.length;i++){u=n.substring(i,i+1),u=="\\"&&(u=n.substring(i,i+2),i++);switch(u){case"*":r=t.length,this._validateArray.length=r,this._validateArray[r]=".novalidation";break;case"{":if(r=n.indexOf("}",i),r==-1)t.push(u);else{var e=n.substring(i+1,r),s=Number(this.replaceAll(e,"?","")),h=e.indexOf("?")>-1;for(h==!0&&(t[t.length-1]=t[t.length-1]+"�"),o=t[t.length-1],f=1;f<s;f++)t.push(o);i=r}break;default:t.push(u)}}return t},n.prototype.lookupMask=function(n){return this._maskArray.length==n?"":this._maskArray[n]},n.prototype.processNonPrintableKeyPress=function(){switch(event.keyCode){case 36:event.returnValue=!1,this.moveToStart(),this.positionAtNextEditable();break;case 37:event.returnValue=!1,this.moveBackward(),this.positionAtPreviousEditable();break;case 39:event.returnValue=!1,this.moveForward(),this.positionAtNextEditable();break;case 35:event.returnValue=!1,this.moveToEnd(),this.positionAtNextEditable()}},n.prototype.findPrevLiteralPos=function(n){for(var t=n;t>0;--t)if(this.isPositionALiteral(t)==!0)return t;return-1},n.prototype.findNextLiteralPos=function(n){for(var t=n;t<this.inputValue().length;t++)if(this.isPositionALiteral(t)==!0)return t;return-1},n.prototype.isPositionALiteral=function(n){var t=this.lookupMask(n);switch(t.substring(0,1)){case"^":case"!":case"#":case"&":case">":case"<":case"@":case"_":return!1;default:return!0}},n.prototype.isKeyCodeGoodAtPosition=function(n,t){for(var f=this.lookupMask(t),r=!1,u,i=0;i<f.length;i++){u=f.substring(i,i+1);switch(u){case"#":this.isKeyNumeric(n)&&(r=!0);break;case"&":case">":case"<":this.isKeyAlpha(n)&&(r=!0);break;case"@":case"^":case"!":(this.isKeyAlpha(n)||this.isKeyNumeric(n))&&(r=!0);break;case"_":r=!0;break;default:u=="\\"&&(i++,u=f.substring(i,i+1)),this.toLowercaseKey(u.charCodeAt(0))==this.toLowercaseKey(n)&&(r=!0)}if(r==!0)break}return r},n.prototype.keyCodeToASCII=function(n){n==null&&(n=event);var t=n.keyCode;if(n.type=="keydown"){if(n.shiftKey==!1){if(t>=65&&t<=90)return t+32;if(t>=48&&t<=57||t>=48&&t<=57)return t;if(t>=96&&t<=106)return t-48;switch(t){case 192:return 96;case 189:return 45;case 187:return 61;case 219:return 91;case 221:return 93;case 220:return 92;case 186:return 59;case 222:return 39;case 188:return 44;case 190:return 46;case 191:return 47}}else{if(t>=65&&t<=90)return t;switch(t){case 48:return 41;case 49:return 33;case 50:return 64;case 51:return 35;case 52:return 36;case 53:return 37;case 54:return 94;case 55:return 38;case 56:return 42;case 57:return 40;case 192:return 126;case 189:return 95;case 187:return 43;case 219:return 123;case 221:return 125;case 220:return 124;case 186:return 58;case 222:return 34;case 188:return 60;case 190:return 62;case 191:return 63}}switch(t){case 106:return 42;case 107:return 43;case 109:return 45;case 110:return 46;case 111:return 47}}return t},n.prototype.processPrintableKeyPress=function(){var u=this.keyCodeToASCII(),t,i,r,n,s;if(u==8)return this.processBackspace();if(u==46)return this.processDelete();if(this.positionAtNextEditable()==!1){event.returnValue=!1;return}if(t=this.caretPos(),event.returnValue=this.isKeyCodeGoodAtPosition(u,t),event.returnValue==!0)this.moveTo(t,1);else{if(i=this.findNextLiteralPos(t),i==-1)return;if(r=this.lookupMask(i),r.substring(0,1)=="\\"&&(r=r.substring(1,2)),r.charCodeAt(0)!=u)return;var f=this.findPrevLiteralPos(t),e="",o=i-t+f+1;for(n=f+1;n<i;n++)if(n<o)e+=this.getDefaultInputForPosition(n);else{if(s=this.inputValue().substring(n-o,n-o+1),!this.isKeyCodeGoodAtPosition(s.charCodeAt(0),n))return;e+=s}this.inputValue(this.inputValue().substring(0,f+1)+e+this.inputValue().substring(i,this.inputValue().length)),this.moveTo(f+e.length+1)}},n.prototype.processDelete=function(){event.returnValue=!1},n.prototype.processBackspace=function(){var n,t;event.returnValue=!1,n=this.caretPos(),this.isInputAllowed(this._maskArray[n])==!1&&this.positionAtPreviousEditable(),this.moveBackward(),n=this.caretPos(),t=this.getDefaultMaskForPosition(n),this.placeChar(t,!0),this.positionAtPreviousEditable()},n.prototype.replaceAll=function(n,t,i){for(var r=n.indexOf(t);r!=-1;)n=n.replace(t,i),r=n.indexOf(t);return n},n}(),editMaskPatterns=function(){function n(){}return n.time12Hour="[ 01]#[*[ 0][1-9]|1[0-2]]:[0-5]# [AP]M",n.time24Hour="[ 012]#[*[ 01]#|2[0-3]]:[0-5]#",n.phone="(###) ###-####",n.socialSecurity="###-##-####",n.dateMMDDYYYY="[ 01]#[*[ 0]#|1[0-2]]/*[ 0123]#[*[ 012]#|3[01]]/*[12]#[*19|2[01]]##",n.ipV6="[#A-F]{4}:[#A-F]{4}:[#A-F]{4}:[#A-F]{4}:[#A-F]{4}:[#A-F]{4}:[#A-F]{4}:[#A-F]{4}",n.temperature="[ #]{3}[*###| ##|  #].# [CFK] ",n}()